<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>S√¢uüêõGPT</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0d0d0d;
      color: white;
    }
    .sidebar {
      width: 250px;
      height: 100vh;
      background: #111;
      padding: 20px;
      float: left;
    }
    .sidebar h2 {
      margin: 0 0 20px;
      color: #7c4dff;
    }
    .chat-container {
      margin-left: 250px;
      padding: 20px;
    }
    .chat-box {
      height: 75vh;
      overflow-y: auto;
      border: 1px solid #333;
      border-radius: 10px;
      padding: 10px;
      background: #1a1a1a;
    }
    .message {
      margin: 10px 0;
    }
    .user {
      color: #4da6ff;
    }
    .bot {
      color: #7cfc00;
    }
    .input-box {
      display: flex;
      margin-top: 10px;
    }
    .input-box input[type="text"] {
      flex: 1;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin-right: 10px;
    }
    .input-box button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: #7c4dff;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>S√¢uüêõGPT</h2>
    <button onclick="newChat()">‚ûï ƒêo·∫°n chat m·ªõi</button>
    <p style="margin-top:20px; color:gray;">‚öôÔ∏è C√†i ƒë·∫∑t</p>
    <p style="color:gray;">‚ùì Tr·ª£ gi√∫p</p>
  </div>

  <div class="chat-container">
    <h1>T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?</h1>
    <p>T√¥i l√† tr·ª£ l√Ω AI th√¥ng minh <b>S√¢uüêõGPT</b>, s·∫µn s√†ng h·ªó tr·ª£ b·∫°n v·ªõi m·ªçi c√¢u h·ªèi v√† nhi·ªám v·ª•.</p>
    
    <div class="chat-box" id="chat"></div>
    
    <div class="input-box">
      <input type="file" id="imageInput" accept="image/*" style="display:none" />
      <button onclick="document.getElementById('imageInput').click()">üìé</button>
      <input type="text" id="messageInput" placeholder="H·ªèi b·∫•t k·ª≥ ƒëi·ªÅu g√¨..." />
      <button onclick="sendMessage()">G·ª≠i</button>
    </div>
  </div>

  <script>
    async function sendMessage() {
      const chat = document.getElementById("chat");
      const msgInput = document.getElementById("messageInput");
      const imageInput = document.getElementById("imageInput");

      const userMsg = msgInput.value;
      if (!userMsg && !imageInput.files.length) return;

      // Hi·ªÉn th·ªã tin nh·∫Øn ng∆∞·ªùi d√πng
      const userDiv = document.createElement("div");
      userDiv.className = "message user";
      userDiv.innerHTML = `<b>B·∫°n:</b> ${userMsg}`;
      chat.appendChild(userDiv);

      // N·∫øu c√≥ ·∫£nh th√¨ hi·ªán ·∫£nh
      if (imageInput.files.length) {
        const img = document.createElement("img");
        img.src = URL.createObjectURL(imageInput.files[0]);
        img.style.maxWidth = "200px";
        img.style.display = "block";
        chat.appendChild(img);
      }

      chat.scrollTop = chat.scrollHeight;

      // G·ª≠i v·ªÅ server
      const formData = new FormData();
      formData.append("message", userMsg);
      if (imageInput.files.length) {
        formData.append("image", imageInput.files[0]);
      }

      const res = await fetch("/chat", {
        method: "POST",
        body: formData
      });

      const data = await res.json();

      // Hi·ªÉn th·ªã tr·∫£ l·ªùi bot
      const botDiv = document.createElement("div");
      botDiv.className = "message bot";
      botDiv.innerHTML = `<b>S√¢uüêõGPT:</b> ${data.reply.content[0].text}`;
      chat.appendChild(botDiv);

      chat.scrollTop = chat.scrollHeight;

      msgInput.value = "";
      imageInput.value = "";
    }

    function newChat() {
      document.getElementById("chat").innerHTML = "";
    }
  </script>
</body>
</html>
